import{j as t,r,g as h,s as i,c as p,R as b}from"./main.js";import{i as A,g as f}from"./hubspot.js";function g({account:s,onRemove:o}){return t.jsx("div",{className:"p-4 rounded-lg border border-gray-200 shadow-sm",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900",children:s.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Portal ID: ",s.hubId]}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Expires at: ",new Date(s.expiresAt).toLocaleString()]})]}),t.jsx("button",{onClick:()=>o(s.hubId),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Remove"})]})})}function j({children:s,className:o="",...n}){return t.jsx("button",{className:`px-4 py-2 bg-[color:var(--color-hubspot)] hover:bg-[color:var(--color-hubspot-hover)] disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-md ${o}`,...n,children:s})}function y(){const[s,o]=r.useState([]),[n,d]=r.useState(!1);r.useEffect(()=>{u()},[]);const u=async()=>{const e=await h();o(e)},m=async()=>{try{d(!0);const e=await A();console.log("Auth Result:",e);const c=await f(e.access_token);console.log("Account Info:",c);const a={hubId:c.portalId,name:c.accountName,accessToken:e.access_token,refreshToken:e.refresh_token,tokenType:e.token_type||"bearer",expiresAt:Date.now()+e.expires_in*1e3};console.log("New Account to be saved:",a);const l=[...s,a];await i(l),o(l)}catch(e){console.error("Failed to add account:",e)}finally{d(!1)}},x=async e=>{const c=s.filter(a=>a.hubId!==e);await i(c),o(c)};return t.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"HubSpot Account Manager"}),t.jsx("div",{className:"space-y-4",children:s.map(e=>t.jsx(g,{account:e,onRemove:x},e.hubId))}),t.jsx(j,{onClick:m,disabled:n,className:"mt-6",children:n?"Adding Account...":"Add HubSpot Account"})]})}p(document.getElementById("root")).render(t.jsx(b.StrictMode,{children:t.jsx(y,{})}));
